<div class="container mt-4">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0">ðŸ›’ Cart List</h5>
        </div>

        <!-- Cart Items Container -->
        <div class="table-responsive">
          <div class="container-fluid py-2" id="cart-items">
            <!-- Header Row -->
            <div class="row font-weight-bold border-bottom pb-2 header">
              <!-- <div class="col-1">No</div> -->
              <div class="col-1"></div>
              <div class="col-1">image</div>
              <div class="col-2">Product Name</div>
              <div class="col-2">Qty</div>
              <div class="col-2">Price</div>
              <div class="col-2">Total</div>
              <div class="col-2">Action</div>
            </div>

            @if (cartService.getCartItem().length == 0){
            <div class="col-12 text-center">
              <h4 style="color: #ccc;">Your cart is empty</h4>
              <a [routerLink]="'/'">Continue Shopping</a>
            </div>
            }

            <!-- Example Cart Item -->
            @for (item of cartService.getCartItem(); track item.id) {
            <div class="row align-items-center py-2 border-bottom cart-item">
              <!-- <div class="col-1">{{item.id}}</div> -->

              <div class="col-1" style="align-items:center; display: flex;">
                <input type="checkbox" class="custom-check form-check-input" [checked]="item.is_select"
                  (change)="cartService.selectCartItem(item)">
              </div>
              <div class="col-1">
                <img class="cart-img" [src]="item.image">
              </div>
              <div class="col-2">
                <h6>{{item.title}}</h6>
                <p>{{item.category}}</p>
              </div>
              <div class="col-2">
                <input class="btn btn-sm btn-outline-danger" type="button" value="-"
                  (click)="cartService.decrementQty(item)">


                <strong class="btn btn-sm" style="font-size: 20px">{{item.qty}}</strong>

                <input class="btn btn-sm btn-outline-primary" type="button" value="+"
                  (click)="cartService.incrementQty(item)">
              </div>
              <div class="col-2">
                <span>{{item.price|currency }}</span>
              </div>
              <div class="col-2">
                <strong>{{item.price*item.qty|currency}}</strong>
              </div>
              <div class="col-2">
                <span class="btn btn-danger btn-sm" (click)="cartService.removeCartItem(item)">Remove</span>
              </div>
            </div>

            }

            <!-- End Example Cart Item -->
          </div>
        </div>

        @if (cartService.getCartItem().length > 0){
        <!-- Footer with Total and Checkout -->
        <div class="card-footer d-flex justify-content-between align-items-center">
          <div>
            <strong>Total:</strong> <span id="cart-total" class="cart-total">{{cartService.getCartTotal() | currency}}</span>
          </div>
          <!-- Checkout Button -->
          <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#checkoutModal">
            Checkout
          </button>

          <!-- Checkout Modal -->
          <div class="modal fade" id="checkoutModal" tabindex="-1" aria-labelledby="checkoutModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">

                <div class="modal-header bg-success text-white">
                  <h5 class="modal-title" id="checkoutModalLabel">Order Summary</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                  <table class="table table-bordered table-striped">
                    <thead>
                      <tr>
                        <th>Product</th>
                        <th>Qty</th>
                        <th>Price</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      @for (item of cartService.getCartItem(); track item.id) {
                      <tr>
                        <td>{{ item.title }}</td>
                        <td>{{ item.qty }}</td>
                        <td>{{ item.price | currency }}</td>
                        <td>{{ item.price * item.qty | currency }}</td>
                      </tr>
                      }
                    </tbody>
                  </table>

                  <div class="text-end">
                    <h5>Total: <strong>{{ cartService.getCartTotal() | currency }}</strong></h5>
                  </div>
                </div>

                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-success" (click)="confirmCheckout()">Confirm Order</button>
                </div>

              </div>
            </div>
          </div>

        </div>
        }


      </div>
    </div>
  </div>
</div>